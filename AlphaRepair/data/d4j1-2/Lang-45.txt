+ if (lower > str.length()) { lower = str.length(); }
  if (upper == -1 || upper > str.length()) {